import Handle from "../handle.js";
import { map } from "rxjs/operators";

export default (function (handle, returnParam) {
  return function (src$) {
    return src$.pipe(map(function (r) {
      var hasQType = r.hasOwnProperty("qReturn") && r.qReturn.hasOwnProperty("qType");

      if (hasQType) {
        var qClass = r.qReturn.qType;
        return new Handle(handle.session, r.qReturn.qHandle, qClass);
      } else if (returnParam) {
        return r[returnParam];
      } else {
        return r;
      }
    }));
  };
});
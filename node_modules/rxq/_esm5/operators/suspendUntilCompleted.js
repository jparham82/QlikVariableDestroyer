import { Observable } from "rxjs";
import { tap } from "rxjs/operators";

export default (function (session) {
  return function (src$) {
    return Observable.create(function (observer) {
      session.suspend();
      src$.subscribe({
        next: function next(n) {
          return observer.next(n);
        },
        error: function error(err) {
          return observer.error(err);
        },
        complete: function complete() {
          session.unsuspend();
          observer.complete();
        }
      });
    });
  };
});